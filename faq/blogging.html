<!--#set var="title" value="Frequently Asked Questions" -->
<!--#include virtual="../inc/header.html" -->
<h2>Frequently Asked Questions: Blogging</h2>

<h3 id="blog">Do you have any software for managing a weblog?</h3>

<p>Not really: there is an installation of <em>Movable Type</em> on the
system but it's rather old (version 2.661) and the MT licensing terms
don't permit upgrading to the newer versions without purchasing a
commercial license. Our intention is to eventually phase out the MT
system.</p>

<p>Our recommendation is that a good, properly free implementation of a
weblog manager is <a title="WordPress blog engine"
href="http://www.wordpress.org/"><em>WordPress</em></a> which is
powerful, standards-compliant and otherwise quite sensible, as well as
having a good license from our point of view. However, it's not really
compatible with running a centralised copy on the system, so you'll have
to install a local copy in your web area: this is very easy and more
flexible for all concerned. Happy blogging!</p>

<p>It is <strong>Very Important</strong> that you keep Wordpress <strong><a href="http://codex.wordpress.org/Upgrading_WordPress">updated</a></strong>. <br/>
Outdated Wordpress installations are frequently compromised and Wordpress has a history of security flaws.<br/>
As of the 2.7 release of Wordpress, updating has become very easy, 
you should be running the latest version of Wordpress.</p>

<h3 id="wp-tips">WordPress Tips: UTF-8 character encodings and RSS feeds</h3>

<p>Some <a
href="http://www.toobusyto.org.uk/tooBusy/archives/2004/11/02/wordpress-12-and-the-srcf/">tips
for using wordpress on the SRCF</a>.</p>

<h3 id="mt2wp">How do I move my weblog from <em>Movable Type</em> to
<em>WordPress</em>?</h3>

<p>Thankfully, this is possible: just follow the instructions below
(courtesy of <a title="Hanna Wallach" href="/~hmw26/">Hanna</a> &mdash;
thanks!)</p>

<p>Preparation:</p>

<ul>
 <li>Make sure your host meets the <a href="http://wordpress.org">WordPress</a> <a href="http://wordpress.org/about/requirements/">requirements</a>. (SRCF users need not worry; pip has everything required.)</li>
 <li>Ask your host admins for a MySQL database, and make sure you know the username and password. (Note: SRCF policy is one database per user/society. If you already have a database and you wish to separate your WP tables from existing tables, use a table prefix such as <tt>wp_</tt>. If you have forgotten your MySQL password, ask the sysadmins to reset it.)</li>
</ul>

<p>WP Installation:</p>

<ul>
 <li>Log into your host. (For SRCF users, this is <tt>shell.srcf.net</tt>.)</li>
 <li>Download the latest version of WP (<tt>wget http://wordpress.org/latest</tt>) and extract the files (e.g. <tt>tar zxvf wordpress-1.0.2-blakey.tar.gz</tt>).</li>
 <li>Move the contents of the extracted directory into <tt>~/public_html</tt> (e.g. <tt>mv wordpress-1.0.2/* ~/public_html</tt>). If you are migrating from MT to WP and would like your new WP blog to reside in the directory currently used by MT (e.g. <tt>~/public_html/mt</tt>) then move the files to that directory instead. If you would like to install WP in a new directory in your webspace (e.g. <tt>~/public_html/wp</tt>), create the new directory (e.g. <tt>mkdir ~/public_html/wp</tt>) and move the files into it.</li>
 <li><tt>cd</tt> to the directory now containing your WP files.</li>
 <li>Use your favourite editor to edit <tt>wp-config-sample.php</tt>, filling in your database details (database name, username, password, database host). (Note: on pip, both your database name and username are your CRSID and the database host is <tt>localhost</tt>.) Change the <tt>$table_prefix</tt> variable to the prefix you wish to use for your WP tables (e.g. <tt>$table_prefix = 'wp_';</tt></li>
 <li>Move <tt>wp-config-sample.php</tt> to <tt>wp-config.php</tt>.</li>
 <li>Make sure <tt>wp-config-sample.php</tt> isn't world-readable: it contains password data! To do this, run <tt>chmod o-r wp-config.php</tt>.</li>
 <li>Run the installation file by pointing your browser at <tt>install.php</tt> in the <tt>wp-admin</tt> directory inside the directory containing your WP files (e.g. <tt>http://CRSID.user.srcf.net/wp/wp-admin/install.php</tt>).</li>
 <li>
  Restrict access to <tt>.../wp-admin/</tt>. To improve security you can restrict access to the /wp-admin/ directory which will hopefully help stop other people being able to log in to it even in the event of a security vunerability in Wordpress. You can also stick this directory behind SSL so that your password cannot easily be stolen during login. <br/>
  This can be achieved using a <tt>.htaccess</tt> file.
  In the <tt>.../wp-admin/</tt> directory make a file called <tt>.htaccess</tt> and put the following in it.
  <pre>RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [R=permanent]

AuthType Ucam-WebAuth
Require user <strong>CRSID</strong></pre>
  Replace CRSID with your CRSID.<br/>
  The <tt>Rewrite</tt> section makes all connections to <tt>.../wp-admin/</tt> use SSL which will protect your password, the <tt>AuthType</tt> section uses Raven to restrict access to the directory, you probably want to use your CRSID on the <tt>Require</tt> line, if you want to allow multiple people access then you could use multiple CRSIDs e.g. <tt>Require user CRSID1 CRSID2</tt> etc. <a href="web-hosting#raven">see this FAQ</a> for more details.<br/>
  <strong>Note: </strong>A file beginning with a <tt>.</tt> is a hidden file on unix. If you are using the gnome <a href="../webdesktop/">graphical desktop</a> then pressing Ctrl-h in nautilus (the default file browser) will show hidden files. (If you are using something else you should be able to work out what to do.) 
 </li>
 <li>Activate a spam filtering plugin like Akismet and a capatcha system like reCAPTCHA. Akismet is installed by default and just needs activiating. Go to <tt>.../wp-admin/plugins.php</tt> to install and activate plugins.</li>
 <li>You may optionaly want to modify your theme so that it no longer puts the Wordpress version into the html - this may help stop hackers finding that you installation is outdated but it does not protect against problems caused by the version you are using being compromised.</li>
</ul>

<p>Accounts:</p>

<ul>
 <li>Log in to WP as <tt>admin</tt> using the password given at the end of the installation process.</li>
 <li>Click on <tt>My Profile</tt> and change the <tt>admin</tt> password using the form provided.</li>
 <li>Click on <tt>Users</tt> and create an account for yourself. (If you planning to import entries from your MT blog, be sure to use the same username as your MT user account. If your MT blog has multiple authors, you must create a user account for each of them.)</li>
</ul>

<p>Migration from MT (based on the tutorial <a href="http://carthik.net/wpdocs/importmt.html">here</a>):</p>

<ul>
 <li>Log into MT.</li>
 <li>Click on the <tt>Manage Weblog</tt> link for the blog you wish to migrate.</li>
 <li>Select <tt>Import/Export</tt> from the left menu.</li>
 <li>Click on the <tt>Export Entries from &hellip;</tt> link at the bottom of page. This should display a large text file (containing all your MT blog entries) in your browser. If text may be displayed as a single long line (as may be the case if you are using IE), the import into WP will not work correctly. Try using a Gecko-based browser (e.g. Netscape, Mozilla or FireFox) instead.</li>
 <li>Save the file displayed in your browser as a text file with the name <tt>import.txt</tt> on your local computer.</li>
 <li>Using SCP or SFTP, upload <tt>import.txt</tt> to the <tt>wp-admin</tt> directory inside the directory containing your WP files on your host. (Note: if necessary, SRCF users may email the sysadmins for help on this step.)</li>
 <li>On your host, <tt>cd</tt> to the <tt>wp-admin</tt> directory.</li>
 <li>Use your favourite editor to change line 2 of <tt>import-mt.php</tt> from <tt>define('MTEXPORT', '');</tt> to <tt>define('MTEXPORT', 'import.txt');</tt>.</li>
 <li>Making sure you're logged into WP as <tt>admin</tt>, point your browser at <tt>import-mt.php</tt> (e.g. <tt>http://CRSID.user.srcf.net/wp/wp-admin/import-mt.php</tt>).</li>
 <li>Click on <tt>Let's go</tt>.</li>
 <li>Log out of the <tt>admin</tt> account and log back into WP using your previously created user account. You may now edit your imported entries. If you imported entries by multiple authors, you will only be able to edit those written by yourself.</li>
</ul>

<!-- <p>Blacklist:</p>

<ul>
 <li>Log into your host.</li>
 <li>Download the latest version of WP Blacklist (<tt>wget http://dinki.mine.nu/word/b2-img/wpblacklist.zip</tt>) and extract the files (e.g. <tt>unzip  wpblacklist.zip</tt>).</li>
 <li>Using your favourite editor, edit the first two lines of <tt>import_blacklist.php</tt>, filling in your database details. (Recall that on pip, both your database name and username are your CRSID, and the database host is <tt>localhost</tt>.)</li>
 <li>Immediately after line 2, insert the following, making sure you use the same prefix (e.g. <tt>wp_</tt>) as the one specified previously in <tt>wp-config.php</tt>.<br />
  <ul class="plain">
   <li><tt>$table_prefix = 'wp_';</tt><br />
       <tt>$blacklist_table_name = $table_prefix . 'blacklist';</tt></li>
  </ul>
 </li>
 <li>Search for <tt>$request = mysql_query("CREATE TABLE blacklist (</tt> and replace it with  <tt>$request = mysql_query("CREATE TABLE $blacklist_table_name (</tt>.</li>
 <li>Similarly, replace <tt>$request = mysql_query("INSERT INTO blacklist (domain) VALUES ('$temp')");</tt> with <tt>$request = mysql_query("INSERT INTO $blacklist_table_name (domain) VALUES ('$temp')");</tt>.</li>
 <li>Move <tt>import_blacklist.php</tt> and <tt>blacklist.txt</tt> to the directory containing your WP files.</li>
 <li>Point your browser to <tt>import_blacklist.php</tt> (e.g. <tt>http://CRSID.user.srcf.net/wp/import_blacklist.php</tt>). This should display several "imported domain/regex" messages.</li>
 <li>Delete <tt>import_blacklist.php</tt> and <tt>blacklist.txt</tt>.</li>
 <li>Open <tt>wp-comments-post.php</tt> in your favourite editor, and insert the following immediately below <tt>require(dirname(__FILE__) . '/wp-config.php');</tt> making sure you use the same prefix (e.g. <tt>wp_</tt>) as the one specified previously in <tt>wp-config.php</tt>.<br />
  <ul class="plain">
   <li><tt>$table_prefix = 'wp_';</tt><br />
       <tt>$blacklist_table_name = $table_prefix . 'blacklist';</tt></li>
  </ul>
 </li>
 <li>Search for the following in <tt>wp-comments-post.php</tt>:<br />
  <ul class="plain">
   <li><tt>if ('manual' == $comment_moderation) {</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;$approved = 0;</tt><br />
       <tt>} else if ('auto' == $comment_moderation) {</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;$approved = 0;</tt><br />
       <tt>} else { // none</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;$approved = 1;</tt><br />
       <tt>}</tt></li>
  </ul>
 </li>
 <li>Paste this immediately below it:<br />
  <ul class="plain">
   <li><tt>$blacklists = $wpdb->get_results("SELECT domain FROM $blacklist_table_name");</tt><br />
       <tt>foreach ($blacklists as $blacklist)  {</tt><br />
       <tt>$regex = "/".$blacklist->domain."/i";</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;if (@preg_match($regex, $url))</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$approved = 0;</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;if (@preg_match($regex, $email))</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$approved = 0;</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;if (@preg_match($regex, $comment))</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$approved = 0;</tt><br />
       <tt>&nbsp;&nbsp;&nbsp;&nbsp;}</tt></li>
  </ul>
 </li>
 <li>Open <tt>menu.txt</tt> in the <tt>wp-admin</tt> directory inside the directory containing your WP files and search for the line containing <tt>3 users.php Users</tt>. Add the following line immediately below it: <tt>3 modBlacklist.php Blacklist</tt>.</li>
 <li>Open modBlacklist.php and insert the following below <tt>/* Edit */</tt> again making sure you use the same prefix (e.g. <tt>wp_</tt>) as the one specified previously in <tt>wp-config.php</tt>:<br />
  <ul class="plain">
   <li><tt>$table_prefix = 'wp_';</tt><br />
       <tt>$blacklist_table_name = $table_prefix . 'blacklist';</tt></li>
  </ul>
 </li>
 <li>Replace <tt>$postquery ="SELECT * FROM blacklist";</tt> with <tt>$postquery ="SELECT * FROM $blacklist_table_name";</tt>.</li>
 <li>Replace both instances of <tt>$request = $wpdb->get_row("SELECT id FROM blacklist WHERE domain='$temp'");</tt> with <tt>$request = $wpdb->get_row("SELECT id FROM $blacklist_table_name WHERE domain='$temp'");</tt>.</li>
 <li>Replace both occurrences of <tt>$request1 = $wpdb->query("INSERT INTO blacklist (domain) VALUES ('$temp')");</tt> with <tt>$request1 = $wpdb->query("INSERT INTO $blacklist_table_name (domain) VALUES ('$temp')");</tt>.</li>
 <li>Move <tt>modBlacklist.php</tt> and <tt>blacklistForm.php</tt> to the <tt>wp-admin</tt> directory inside the directory containing your WP files.</li>
</ul> This does not work as the link is broken-->

<p>Redirection of old MT entries using <tt>.htaccess</tt>:</p>

<ul>
 <li>Note that this method only works if you have been using MT permalinks containing entry IDs (e.g. <tt>http://CRSID.user.srcf.net/mt/archives/000123.html</tt>).</li>
 <li>Log into WP.</li>
 <li>Click on <tt>Options</tt> and select <tt>Permalinks</tt>.</li>
 <li>Enter <tt>/%year%/%monthnum%/%day%/%postname%/</tt> into the text field.</li>
 <li>write text editor, create a file <tt>.htaccess</tt> in the directory containing your WP files. Copy and paste the rewrite rules displayed in the text area into <tt>.htaccess</tt>.</li>
 <li>Paste the following text into your <tt>.htaccess</tt> file, immediately below the rewrite rules:<br />
  <ul class="plain">
   <li><tt>Redirect Permanent /mt/index.html http://CRSID.user.srcf.net/wp/index.php</tt><br />
       <tt>Redirect Permanent /mt/index.rdf http://CRSID.user.srcf.net/wp/wp-rdf.php</tt><br />
       <tt>Redirect Permanent /mt/index.xml http://CRSID.user.srcf.net/wp/wp-rss.php</tt></li>
   </ul>
 </li>
 <li>Log into MT.</li>
 <li>Click on the <tt>Manage Weblog</tt> link for the blog whose posts you wish to redirect.</li>
 <li>Select <tt>Templates</tt> from the left menu.</li>
 <li>Click on <tt>Create new index template</tt>.</li>
 <li>Call the new template <tt>redirect</tt> and specify <tt>redirect.php</tt> as its output file.</li>
 <li>Assuming your MT archives are in <tt>~/public_html/mt/archives/</tt> and your WP blog files are in <tt>~/public_html/wp/</tt>, the template's body should contain the following:<br />
  <ul class="plain">
   <li><tt>&lt;?php</tt><br />
       <tt>require('wp-config.php');</tt><br />
       <tt>header('Content-type: text/plain');</tt><br />
       <tt>?&gt;</tt><br />
       <tt>&lt;MTEntries lastn="999999'&gt;&lt;/MTentries&gt;</tt><br />
       <tt>Redirect Permanent /mt/archives/&lt;?php echo str_pad("&lt;$MTEntryID$&gt;", 6, '0', STR_PAD_LEFT); ?&gt;.html http://CRSID.user.srcf.net/wp/&lt;$MTArchiveDate format="%Y/%m/%d"$&gt;/&lt;?php echo sanitize_title("&lt;$MTEntryTitle$&gt;"); ?&gt;</tt></li>
  </ul>
 </li>
 <li>Save and rebuild the template.</li>
 <li>On pip, you also need to change the owner of <tt>redirect.php</tt> from <tt>mt</tt> to your CRSID. Since the file is owned by <tt>mt</tt>, you cannot do this using <tt>chmod</tt>. Instead, you will need to create a new file <tt>tmp.php</tt>, copy the text from <tt>redirect.php</tt> to <tt>tmp.php</tt>, delete <tt>redirect.php</tt> and rename <tt>tmp.php</tt> to <tt>redirect.php</tt>.</li>
 <li>Point your browser to <tt>redirect.php</tt> (e.g. <tt>http://CRSID.user.srcf.net/mt/redirect.php</tt>. This should display a list of permanent redirect statements. Copy the list displayed on your browser into your <tt>.htaccess</tt> file, below the rewrite statements.</li>
</ul>

<p>And that's it!</p>

<!--#include virtual="../inc/footer.html" -->
